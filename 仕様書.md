# 支出記録アプリ（Expense Tracker）仕様書

## 概要

支出記録アプリ（Expense Tracker）は、ユーザーの日々の支出を記録・管理するWebアプリケーションです。ブラウザ上で動作し、localStorageを使用してデータを保存するため、サーバーサイドの実装は不要です。ユーザーは支出の追加、編集、削除、カテゴリ別の集計、月次・年次の支出分析を行うことができます。

## 目的

- **支出の可視化**: 日々の支出を記録し、自分のお金の流れを把握できるようにする
- **節約意識の向上**: 支出データを分析することで、無駄な支出に気づき、節約の意識を高める
- **予算管理**: カテゴリ別や月別の支出を確認し、予算計画を立てやすくする
- **シンプルな操作**: 複雑な機能を排除し、直感的に操作できるユーザーインターフェースを提供する
- **オフライン対応**: localStorageを使用することで、インターネット接続がなくても利用可能

## 画面構成

### 1. メイン画面（支出一覧画面）

- **表示内容**:
  - 支出項目の一覧（日付、カテゴリ、金額、メモ）
  - 合計支出額の表示
  - フィルタリング・ソート機能
  - 新規支出追加ボタン

- **レイアウト**:
  - ヘッダー: アプリタイトル、月次/年次切替ボタン
  - 統計エリア: 今月の合計支出、カテゴリ別支出の円グラフまたは棒グラフ
  - 一覧エリア: 支出項目のテーブル表示
  - フッター: 新規追加ボタン

### 2. 支出追加・編集画面

- **表示内容**:
  - 日付入力フィールド（日付ピッカー）
  - カテゴリ選択（プルダウンメニュー）
  - 金額入力フィールド（数値）
  - メモ入力フィールド（テキストエリア）
  - 保存ボタン、キャンセルボタン

- **レイアウト**:
  - モーダルダイアログまたは別画面として実装
  - 入力フォームを中央に配置
  - バリデーションエラーメッセージ表示エリア

### 3. 統計・分析画面

- **表示内容**:
  - 期間選択（月別、年別）
  - カテゴリ別支出の円グラフ
  - 日別/月別支出の折れ線グラフ
  - カテゴリ別支出の表

- **レイアウト**:
  - タブまたはセクションでグラフと表を切り替え
  - グラフはChart.jsなどのライブラリを使用

## 入出力仕様

### 入力仕様

#### 支出追加・編集フォーム

| 項目名 | タイプ | 必須 | 制約 | 説明 |
|--------|--------|------|------|------|
| 日付 | date | 必須 | YYYY-MM-DD形式 | 支出が発生した日付 |
| カテゴリ | select | 必須 | 選択肢から選択 | 支出のカテゴリ（食費、交通費、娯楽、日用品、その他など） |
| 金額 | number | 必須 | 正の数値、整数 | 支出金額（円） |
| メモ | textarea | 任意 | 最大200文字 | 支出に関する補足情報 |

#### フィルタリング機能

| 項目名 | タイプ | 説明 |
|--------|--------|------|
| 日付範囲 | date range | 開始日から終了日までの範囲を指定 |
| カテゴリ | select | 特定のカテゴリのみ表示 |
| 金額範囲 | number range | 最小金額から最大金額までの範囲を指定 |

#### ソート機能

- 日付（昇順・降順）
- 金額（昇順・降順）
- カテゴリ（あいうえお順）

### 出力仕様

#### 支出一覧表示

| 項目名 | タイプ | 表示形式 | 説明 |
|--------|--------|----------|------|
| 日付 | date | YYYY/MM/DD | 支出日 |
| カテゴリ | string | テキスト + アイコン | カテゴリ名 |
| 金額 | number | ¥1,234 | カンマ区切り、通貨記号付き |
| メモ | string | テキスト（省略表示可） | メモ内容 |
| 操作 | buttons | 編集・削除ボタン | 各支出項目に対するアクション |

#### 統計情報表示

- **合計支出額**: 選択期間内の全支出の合計（¥123,456形式）
- **カテゴリ別支出**: 各カテゴリの支出額と全体に占める割合（%）
- **平均日次支出**: 期間を日数で割った平均支出額
- **最大支出**: 期間内の最大支出額とその項目
- **最小支出**: 期間内の最小支出額とその項目

## 機能一覧

### 1. 支出管理機能

#### 1.1 支出の追加
- ユーザーが新しい支出を記録できる
- 日付、カテゴリ、金額、メモを入力
- 入力値のバリデーション（必須項目チェック、数値チェック）
- 追加成功時に一覧に反映

#### 1.2 支出の編集
- 既存の支出項目を編集できる
- 編集画面で各項目を変更可能
- 変更内容を保存して一覧に反映

#### 1.3 支出の削除
- 支出項目を削除できる
- 削除前に確認ダイアログを表示
- 削除後に一覧から即座に反映

#### 1.4 支出の表示
- 支出一覧を時系列で表示
- ページネーションまたは無限スクロール対応
- レスポンシブデザインでスマートフォンにも対応

### 2. フィルタリング・検索機能

#### 2.1 日付範囲でのフィルタ
- 開始日と終了日を指定して期間を絞り込み
- カレンダーUIで直感的に選択

#### 2.2 カテゴリでのフィルタ
- 特定のカテゴリのみを表示
- 複数カテゴリの選択（将来拡張）

#### 2.3 金額範囲でのフィルタ
- 最小金額と最大金額を指定して絞り込み

#### 2.4 検索機能
- メモ内容をキーワード検索

### 3. ソート機能

- 日付順（昇順・降順）で並び替え
- 金額順（昇順・降順）で並び替え
- カテゴリ順（あいうえお順）で並び替え

### 4. 統計・分析機能

#### 4.1 合計表示
- 現在表示されている期間の合計支出額を表示
- 今月の合計、今年の合計をワンタップで表示

#### 4.2 カテゴリ別集計
- 各カテゴリの支出合計を計算
- 円グラフまたは棒グラフで可視化
- 割合（%）も表示

#### 4.3 期間別集計
- 日別、週別、月別、年別の集計
- 折れ線グラフで推移を表示

#### 4.4 平均・最大・最小値の表示
- 平均日次支出額
- 最大支出額とその項目
- 最小支出額とその項目

### 5. データ管理機能

#### 5.1 localStorageへの保存
- 支出データをlocalStorageに自動保存
- ブラウザを閉じてもデータが保持される

#### 5.2 データのエクスポート
- 全データをJSON形式でエクスポート
- CSV形式でのエクスポート（将来拡張）

#### 5.3 データのインポート
- JSONファイルからデータをインポート
- 既存データとのマージまたは上書き

#### 5.4 データの削除
- 全データを一括削除（確認ダイアログ必須）

## 使用技術

### HTML
- セマンティックHTML5を使用
- アクセシビリティを考慮した構造
- フォーム要素の適切な使用
- ARIA属性の活用

### CSS
- モダンなCSS（Flexbox、Grid）
- レスポンシブデザイン（モバイルファースト）
- CSS変数を使用したテーマ管理
- アニメーション・トランジション効果
- 外部CSSフレームワークは使用しない（バニラCSS）

### JavaScript
- バニラJavaScript（ES6+）
- モジュール化されたコード構造
- イベントデリゲーション
- 非同期処理（Promise、async/await）
- DOM操作の最適化

### 外部ライブラリ（オプション）

- **Chart.js**: グラフ描画用
- その他、軽量なユーティリティライブラリを必要に応じて使用

### 開発環境

- ローカル開発サーバー（Live Server等）
- ブラウザの開発者ツール

## データ構造（localStorage利用）

### データ保存形式

localStorageに以下のキーでデータを保存：

```javascript
{
  "expenseTracker_expenses": [
    {
      "id": "unique_id_string",
      "date": "2024-01-15",
      "category": "食費",
      "amount": 1250,
      "memo": "昼食代"
    }
  ],
  "expenseTracker_categories": [
    "食費",
    "交通費",
    "娯楽",
    "日用品",
    "光熱費",
    "その他"
  ],
  "expenseTracker_settings": {
    "currency": "¥",
    "dateFormat": "YYYY-MM-DD",
    "defaultCategory": "その他"
  }
}
```

### データモデル

#### 支出オブジェクト（Expense）

| プロパティ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| id | string | 必須 | 一意の識別子（UUIDまたはタイムスタンプ+ランダム文字列） |
| date | string | 必須 | 支出日付（ISO 8601形式: YYYY-MM-DD） |
| category | string | 必須 | カテゴリ名 |
| amount | number | 必須 | 支出金額（整数） |
| memo | string | 任意 | メモ内容（最大200文字） |
| createdAt | number | 必須 | 作成日時（Unixタイムスタンプ） |
| updatedAt | number | 任意 | 更新日時（Unixタイムスタンプ） |

#### カテゴリリスト

- デフォルトカテゴリを配列で保持
- ユーザーがカスタムカテゴリを追加できる（将来拡張）

#### 設定オブジェクト（Settings）

| プロパティ | 型 | デフォルト値 | 説明 |
|-----------|-----|------------|------|
| currency | string | "¥" | 通貨記号 |
| dateFormat | string | "YYYY-MM-DD" | 日付表示形式 |
| defaultCategory | string | "その他" | デフォルトカテゴリ |

### データ操作

#### 保存処理

```javascript
// 支出データの保存例
function saveExpense(expense) {
  const expenses = loadExpenses();
  expenses.push(expense);
  localStorage.setItem('expenseTracker_expenses', JSON.stringify(expenses));
}
```

#### 読み込み処理

```javascript
// 支出データの読み込み例
function loadExpenses() {
  const data = localStorage.getItem('expenseTracker_expenses');
  return data ? JSON.parse(data) : [];
}
```

#### 更新処理

```javascript
// 支出データの更新例
function updateExpense(id, updatedExpense) {
  const expenses = loadExpenses();
  const index = expenses.findIndex(e => e.id === id);
  if (index !== -1) {
    expenses[index] = { ...updatedExpense, updatedAt: Date.now() };
    localStorage.setItem('expenseTracker_expenses', JSON.stringify(expenses));
  }
}
```

#### 削除処理

```javascript
// 支出データの削除例
function deleteExpense(id) {
  const expenses = loadExpenses();
  const filtered = expenses.filter(e => e.id !== id);
  localStorage.setItem('expenseTracker_expenses', JSON.stringify(filtered));
}
```

### データ永続化

- localStorageの容量制限（約5-10MB）を考慮
- データのバックアップ機能を実装
- データが破損した場合の復旧機能（将来拡張）

### データマイグレーション

- 将来的なデータ構造の変更に対応するため、バージョン管理を行う
- バージョン番号をlocalStorageに保存し、必要に応じてデータを変換

---

**最終更新日**: 2024年

